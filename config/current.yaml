data:
  limit_rows: null
  num_workers: 2
  persistent_workers: true
  pin_memory: true
  prefetch_factor: 2
  split:
    seed: 42
    shuffle: true
    test_ratio: 0.1
    train_ratio: 0.8
    val_ratio: 0.1
expert_col: 'no'
experts:
  critical:
    activation: gelu
    dropout: 0.0
    hidden_layers:
    - 512
    - 256
    - 128
    - 64
  extra:
    activation: gelu
    dropout: 0.0
    hidden_layers:
    - 512
    - 256
    - 128
  gas:
    activation: gelu
    dropout: 0.0
    hidden_layers:
    - 512
    - 256
    - 128
    - 64
  liquid:
    activation: gelu
    dropout: 0.0
    hidden_layers:
    - 512
    - 256
    - 128
    - 64
exports:
  cleanup_allowlist_dirs:
  - exports
  cleanup_other_csv: true
  enabled: true
  files:
    finetune_test_metrics: finetune_test_metrics.csv
    finetune_test_predictions: finetune_test_predictions.csv
    gate_test_metrics: gate_test_metrics.csv
    gate_test_predictions: gate_test_predictions.csv
    pretrain_best_metrics: pretrain_best_metrics.csv
    pretrain_best_predictions: pretrain_best_predictions.csv
  outdir_name: exports
  predictions_keep:
    keep_expert_col: true
    keep_features: true
feature_cols:
- T_r (-)
- p_r (-)
- omega (-)
- p_c (Pa)
- T_c (K)
- mu ((J*m^3/kmol)^0.5)
gate:
  activation: relu
  dropout: 0.05
  hidden_layers:
  - 512
  - 256
  - 128
  - 64
loss:
  extreme_alpha: 4.0
  huber_delta: 1.0
  lambda_entropy: -0.01
  lambda_extreme: 1.0
  lambda_nonneg: 3.08e-05
  lambda_relative: 0.0
  lambda_smooth: 0.0
  region_weights:
    enabled: true
    weights:
      1: 1.0
      2: 1.0
      3: 2.0
      4: 1.2
  supervised: mse
  target_normalize:
    enabled: true
    eps: 1.0e-12
    mode: per_target_std
model:
  input_dim: 8
  output_dim: 4
optuna:
  directions:
  - minimize
  - minimize
  - minimize
  enabled: false
  n_trials: 50
  sampler: tpe
  search_space: {}
  storage: null
  study_name: uni_pvt_mo
paths:
  data: data/Water.csv
  save_dir: results/2026-01-11_20-16-08
  scaler: results/2026-01-11_20-16-08/scaler.pkl
pinn:
  R: 8.31446261815324
  compute_every_steps: 2
  enabled: true
  input_mode: reduced
  lambda_H: 0.05
  lambda_S: 0.05
  lambda_phi: 0.05
  p_feature: p_r (-)
  p_to_Pa: 1.0e6
  schedule:
    apply_in_finetune: true
    apply_in_gate_train: true
    apply_in_pretrain: true
  t_feature: T_r (-)
  z_name: Z (-)
pt_viz:
  allow_fail: true
  diff_mode: pred_minus_true
  enabled: true
  per_target: true
runtime:
  amp:
    enabled: true
  compile:
    enabled: false
  device: auto
  tf32:
    enabled: true
shap:
  enabled: true
  max_samples: 2000
  save_csv: false
targets:
- Z (-)
training:
  batch_size: 128
  early_stopping:
    enabled: true
    min_delta: 0.0
    monitor: val_loss
    patience: 20
  eval:
    eval_every_epochs: 1
    log_every_steps: 50
  finetune:
    enabled: true
    epochs: 80
    learning_rate: 0.0007
    min_lr: 5.0e-06
    unfreeze:
    - gas
    - liquid
    - critical
    - extra
  gate_epochs: 50
  gate_temperature_schedule:
    enabled: true
    end: 0.8
    start: 1.5
  gradient_clip_norm: 0.0
  learning_rate: 0.0005
  lr_scheduler:
    enabled: true
    gamma: 0.5
    min_lr: 1.0e-05
    name: cosine
    plateau:
      factor: 0.5
      min_lr: 1.0e-06
      mode: min
      patience: 8
      threshold: 0.0
    step_size: 20
    warmup_epochs: 5
    warmup_start_factor: 0.2
  optimizer:
    betas:
    - 0.9
    - 0.999
    eps: 1.0e-08
    name: adamw
  pretrain_epochs: 30
  seed: 42
  weight_decay: 0.0
